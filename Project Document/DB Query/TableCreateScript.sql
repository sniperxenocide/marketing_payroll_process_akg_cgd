create table xxakg.xxakg_operating_unit
(
	id number generated by default as identity ,
	ou_id number not null,
	ou_name varchar2(100) not null,
	constraint xxakg_operating_unit_pk primary key (id)
);

create table xxakg.xxakg_zone
(
	zone_id number not null,
	zone varchar2(1) not null,
	ou_id number not null,
	constraint fk_xxakg_zone_operating_unit foreign key (ou_id) references xxakg.xxakg_operating_unit(id),
	constraint xxakg_zone_pk primary key(zone_id)
);

create table xxakg.xxakg_grade
(
	grade_id number not null,
	grade varchar2(2) not null,
	ou_id number not null,
	constraint fk_xxakg_grade_operating_unit foreign key (ou_id) references xxakg.xxakg_operating_unit(id),
	constraint xxakg_grade_pk primary key(grade_id)
);

create table xxakg.xxakg_designation
(
	designation_id number not null,
	designation varchar2(40) not null,
	ou_id number not null,
	constraint fk_xxakg_designation_operating_unit foreign key (ou_id) references xxakg.xxakg_operating_unit(id),
	constraint xxakg_designation_pk primary key (designation_id)
);


// start from here

create table xxakg.xxakg_node_zone
(
	node_id number not null,
	zone_id number not null,
	ou_id number not null,
	constraint fk_xxakg_node_zone_operating_unit foreign key (ou_id) references xxakg.xxakg_operating_unit(id),
	constraint xxakg_node_zone_pk primary key (node_id),
	constraint fk_xxakg_node_zone_zone foreign key (zone_id) references xxakg.xxakg_zone(zone_id)
);

create table xxakg.xxakg_sales_range_salary
(
	id number generated by default as identity ,
	ou_id number not null,
	grade_id number not null,
	designation_id number not null,
	zone_id number not null,
	min_sales number not null,
	max_sales binary_float not null,
	salary number not null,
	
	constraint xxakg_sales_range_salary_pk primary key (id),
	constraint fk_xxakg_sales_range_salary_operating_unit foreign key (ou_id) references xxakg.xxakg_operating_unit(id),
	constraint fk_xxakg_sales_range_salary_grade foreign key (grade_id) references xxakg.xxakg_grade(grade_id),
	constraint fk_xxakg_sales_range_salary_designation foreign key (designation_id) references xxakg.xxakg_designation(designation_id),
	constraint fk_xxakg_sales_range_salary_zone foreign key (zone_id) references xxakg.xxakg_zone(zone_id)
);

create table xxakg.xxakg_period
(
	id number generated by default as identity,
	ou_id number not null,
	period_year number not null,
	period_number number not null,
	period_code varchar2(10) not null,
	description varchar2(30) not null,
	start_date date not null,
	end_date date not null,
	status varchar2(1) not null,
	process_date varchar2(50),
	
	constraint fk_xxakg_period_operating_unit foreign key (ou_id) references xxakg.xxakg_operating_unit(id),
	constraint xxakg_period_pk primary key (id)
);

create table xxakg.xxakg_emp_basic_salary
(
	id number generated by default as identity,
	ou_id number not null,
	period_id number not null,
	employee_id number not null,
	node_id number not null,
	total_sales number(*,2) not null,
	attendance number not null,
	average_sales number(*,2) not null,
	salary_id number not null,
	
	constraint xxakg_emp_basic_salary_pk primary key (id),
	constraint fk_xxakg_emp_basic_salary_operating_unit foreign key (ou_id) references xxakg.xxakg_operating_unit(id),
	constraint fk_xxakg_emp_basic_salary_period foreign key (period_id) references xxakg.xxakg_period(id),
	constraint fk_xxakg_emp_basic_salary_sales_range_salary foreign key (salary_id) references xxakg.xxakg_sales_range_salary(id)
);

-- populating operating unit table
insert into xxakg.xxakg_operating_unit (ou_id,ou_name) values(665,'Consumer Goods Operating Unit');
-- populating operating unit table


-- populate zone table 
insert into xxakg.xxakg_zone (zone_id,zone,ou_id) values (1,'A',1);
insert into xxakg.xxakg_zone (zone_id,zone,ou_id) values (2,'B',1);
-- populate zone table 

-- populate grade table 
insert into xxakg.xxakg_grade (grade_id,grade,ou_id) values (1,'A+',1);
insert into xxakg.xxakg_grade (grade_id,grade,ou_id) values (2,'A',1);
insert into xxakg.xxakg_grade (grade_id,grade,ou_id) values (3,'B',1);
insert into xxakg.xxakg_grade (grade_id,grade,ou_id) values (4,'C',1);
insert into xxakg.xxakg_grade (grade_id,grade,ou_id) values (5,'P',1);
-- populate grade table 


-- populate designation table 
insert into xxakg.xxakg_designation(designation_id,designation,ou_id) values (1,'SR-CPT',1);
insert into xxakg.xxakg_designation(designation_id,designation,ou_id) values (8,'CM-CPT',1);
insert into xxakg.xxakg_designation(designation_id,designation,ou_id) values (19,'CSR-CPT',1);
-- populate designation table 


-- populate node_zone table 
insert into xxakg.xxakg_node_zone(node_id,zone_id,ou_id) values (382,2,1);
insert into xxakg.xxakg_node_zone(node_id,zone_id,ou_id) values (383,2,1);
insert into xxakg.xxakg_node_zone(node_id,zone_id,ou_id) values (384,2,1);
insert into xxakg.xxakg_node_zone(node_id,zone_id,ou_id) values (387,1,1);
insert into xxakg.xxakg_node_zone(node_id,zone_id,ou_id) values (394,1,1);
insert into xxakg.xxakg_node_zone(node_id,zone_id,ou_id) values (460,1,1);
insert into xxakg.xxakg_node_zone(node_id,zone_id,ou_id) values (490,2,1);
insert into xxakg.xxakg_node_zone(node_id,zone_id,ou_id) values (498,2,1);
insert into xxakg.xxakg_node_zone(node_id,zone_id,ou_id) values (500,2,1);
insert into xxakg.xxakg_node_zone(node_id,zone_id,ou_id) values (501,2,1);
insert into xxakg.xxakg_node_zone(node_id,zone_id,ou_id) values (605,2,1);
insert into xxakg.xxakg_node_zone(node_id,zone_id,ou_id) values (613,2,1);
-- populate node_zone table 


-- populate sales_range_salary table 
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,1,1,1,100000,BINARY_FLOAT_INFINITY,16000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,1,1,2,100000,BINARY_FLOAT_INFINITY,16000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,1,20,1,100000,BINARY_FLOAT_INFINITY,16000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,1,20,2,100000,BINARY_FLOAT_INFINITY,16000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,1,8,1,20000,BINARY_FLOAT_INFINITY,12500);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,1,8,2,20000,BINARY_FLOAT_INFINITY,12500);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,1,21,1,20000,BINARY_FLOAT_INFINITY,12500);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,1,21,2,20000,BINARY_FLOAT_INFINITY,12500);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,2,1,1,75000,99999,15000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,2,1,2,50000,99999,15000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,2,20,1,75000,99999,15000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,2,20,2,50000,99999,15000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,2,8,1,17000,19999,12000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,2,8,2,17000,19999,12000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,2,21,1,17000,19999,12000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,2,21,2,17000,19999,12000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,3,1,1,45000,74999,13500);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,3,1,2,30000,49999,13500);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,3,20,1,45000,74999,13500);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,3,20,2,30000,49999,13500);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,3,8,1,14000,16999,11000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,3,8,2,14000,16999,11000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,3,21,1,14000,16999,11000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,3,21,2,14000,16999,11000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,4,1,1,25000,44999,12000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,4,1,2,20000,29999,12000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,4,20,1,25000,44999,12000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,4,20,2,20000,29999,12000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,4,8,1,11000,13999,10000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,4,8,2,11000,13999,10000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,4,21,1,11000,13999,10000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,4,21,2,11000,13999,10000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,5,1,1,18750,24999,10250);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,5,1,2,15000,19999,10250);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,5,20,1,18750,24999,10250);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,5,20,2,15000,19999,10250);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,5,8,1,7500,10999,8000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,5,8,2,7500,10999,8000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,5,21,1,7500,10999,8000);
insert into xxakg.xxakg_sales_range_salary (ou_id,grade_id,designation_id,zone_id,min_sales,max_sales,salary) values (1,5,21,2,7500,10999,8000);
-- populate sales_range_salary table 


-- populate period table 
declare
    start_date_ date := '1-jan-2019';
    end_date_ date := '1-jan-2022';
    
    cnt integer := -1*months_between(start_date_,end_date_);
    current_date_ date := start_date_;
	ou_id_ integer := 1;
	period_year_ integer;
	period_number_ integer;
	period_code_ varchar2(10);
	description_ varchar2(30);
	start_dt_ date;
	end_dt_ date;
	status_ varchar2(1) := 'D';
begin
	for i in 1 .. cnt loop
        period_year_ := to_char(current_date_,'yyyy');
        period_number_ := to_char(current_date_,'mm');
        period_code_ := to_char(current_date_,'MON-yy');
        description_ := to_char(current_date_,'Month-yyyy');
        start_dt_ := current_date_;
        end_dt_ := last_day(current_date_);  
        /*
        dbms_output.put_line( period_year_ || '   ' || period_number_ || '   ' || 
                                period_code_ || '   ' || description_ || '   ' || 
                                start_dt_ || '   ' || end_dt_ || '   ' || status_);
        */
		
        --/*
		insert into xxakg.xxakg_period(ou_id,period_year,period_number,period_code,description,start_date,end_date,status) 
				values(ou_id_,period_year_,period_number_,period_code_,description_,start_dt_,end_dt_,status_);
		--*/
        current_date_ := ADD_MONTHS(current_date_,1);
	end loop;
end ;
-- populate period table 





